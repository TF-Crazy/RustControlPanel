<Window x:Class="RustControlPanel.Views.Windows.LoginWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:RustControlPanel.ViewModels"
        Title="Rust Control Panel" 
        Height="540" Width="820"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent">

    <Window.DataContext>
        <vm:LoginViewModel/>
    </Window.DataContext>

    <Border Background="#1A1D23" CornerRadius="8" BorderBrush="#2D3139" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="32"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- TitleBar -->
            <Border Background="#0F1115" CornerRadius="8,8,0,0" BorderBrush="#2D3139" BorderThickness="0,0,0,1" MouseLeftButtonDown="OnTitleBarMouseDown">
                <Grid Margin="12,0">
                    <TextBlock Text="Rust Control Panel" Foreground="#E0E0E0" FontSize="13" VerticalAlignment="Center"/>
                    <Button Content="âœ•" Click="OnCloseClick" HorizontalAlignment="Right" Width="36" Height="32" FontSize="14" Foreground="#808080" Background="Transparent" BorderThickness="0" Cursor="Hand"/>
                </Grid>
            </Border>

            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="290"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Saved Servers -->
                <Border Background="#0F1115" BorderBrush="#2D3139" BorderThickness="0,0,1,0">
                    <Grid Margin="16,20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBlock Text="Saved Servers" FontSize="14" FontWeight="SemiBold" Foreground="#E0E0E0" Margin="0,0,0,12"/>
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <ItemsControl ItemsSource="{Binding SavedServers}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Margin="0,0,0,8" Padding="12,10" Background="#1E2228" BorderBrush="#2D3139" BorderThickness="1" CornerRadius="4" Cursor="Hand">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>
                                                <TextBlock Text="{Binding DisplayName}" FontSize="13" FontWeight="SemiBold" Foreground="#E0E0E0"/>
                                                <TextBlock Grid.Row="1" FontSize="11" Foreground="#808080" Margin="0,3,0,8">
                                                    <Run Text="{Binding Host}"/>:<Run Text="{Binding Port}"/>
                                                </TextBlock>
                                                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
                                                    <Button Content="Connect" Command="{Binding DataContext.QuickConnectCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}" Padding="12,4" FontSize="11" Background="#00D9FF" Foreground="White" BorderThickness="0" Cursor="Hand" Margin="0,0,6,0"/>
                                                    <Button Content="âœ•" Command="{Binding DataContext.RemoveServerCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}" Width="24" Height="24" FontSize="12" Background="Transparent" Foreground="#808080" BorderThickness="0" Cursor="Hand"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                </Border>

                <!-- Form -->
                <Grid Grid.Column="1" Margin="40,30">
                    <StackPanel VerticalAlignment="Center" MaxWidth="340">
                        <TextBlock Text="ðŸ”·" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                        <TextBlock Text="Connect" FontSize="20" FontWeight="SemiBold" Foreground="#E0E0E0" HorizontalAlignment="Center" Margin="0,0,0,32"/>
                        
                        <TextBlock Text="HOST" FontSize="11" FontWeight="SemiBold" Foreground="#A0A0A0" Margin="0,0,0,6"/>
                        <TextBox x:Name="HostTextBox" Text="{Binding Host, UpdateSourceTrigger=PropertyChanged}" Height="40" Padding="12" FontSize="14" Background="#1E2228" Foreground="#FFFFFF" CaretBrush="#00D9FF" BorderBrush="#2D3139" BorderThickness="1" Margin="0,0,0,16"/>
                        
                        <TextBlock Text="PORT" FontSize="11" FontWeight="SemiBold" Foreground="#A0A0A0" Margin="0,0,0,6"/>
                        <TextBox x:Name="PortTextBox" Text="{Binding Port, UpdateSourceTrigger=PropertyChanged}" Height="40" Padding="12" FontSize="14" Background="#1E2228" Foreground="#FFFFFF" CaretBrush="#00D9FF" BorderBrush="#2D3139" BorderThickness="1" Margin="0,0,0,16" PreviewTextInput="OnPortPreviewTextInput"/>
                        
                        <TextBlock Text="PASSWORD" FontSize="11" FontWeight="SemiBold" Foreground="#A0A0A0" Margin="0,0,0,6"/>
                        <PasswordBox x:Name="PasswordBox" Height="40" Padding="12" FontSize="14" Background="#1E2228" Foreground="#FFFFFF" CaretBrush="#00D9FF" BorderBrush="#2D3139" BorderThickness="1" Margin="0,0,0,24" PasswordChanged="OnPasswordChanged"/>
                        
                        <Button Click="OnConnectClick" Content="Connect" Height="42" FontSize="14" FontWeight="SemiBold" Background="#00D9FF" Foreground="White" BorderThickness="0" Cursor="Hand"/>
                    </StackPanel>
                </Grid>
            </Grid>

            <!-- Error Popup -->
            <Border x:Name="ErrorPopup" Grid.RowSpan="2" Background="#DD000000" Visibility="Collapsed" Panel.ZIndex="1000">
                <Border Background="#1E2228" BorderBrush="#FF4444" BorderThickness="1" CornerRadius="6" Padding="32,24" MaxWidth="360" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <StackPanel>
                        <TextBlock Text="âš ï¸" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                        <TextBlock x:Name="ErrorMessage" Text="Error" FontSize="14" Foreground="#E0E0E0" TextWrapping="Wrap" HorizontalAlignment="Center" Margin="0,0,0,20"/>
                        <Button Content="OK" Click="OnErrorOkClick" Height="36" Padding="32,0" Background="#FF4444" Foreground="White" BorderThickness="0" FontSize="13" Cursor="Hand" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Border>
        </Grid>
    </Border>
</Window>
